extends Line2D
var pos = Vector2(0,0)
var done = false
@export var speed = 10
var a = 0
@export var len = 100
@export var goal = false
var score = 10000
#there has to be a better way right :(
var goals = [[Vector2(112.0, 0.0), Vector2(117.8824, -0.7), Vector2(122.4486, -1.89), Vector2(126.3965, -3.423), Vector2(130.0025, -5.1961), Vector2(133.4025, -7.13727), Vector2(136.6718, -9.19609), Vector2(139.8553, -11.33726), Vector2(142.9814, -13.53608), Vector2(146.0686, -15.77526), Vector2(149.1292, -18.04268), Vector2(152.1713, -20.32988), Vector2(155.2006, -22.63091), Vector2(158.2211, -24.94164), Vector2(161.2354, -27.25915), Vector2(164.2454, -29.5814), Vector2(167.2524, -31.90698), Vector2(170.2573, -34.23489), Vector2(173.2607, -36.56442), Vector2(176.2631, -38.89509), Vector2(179.2648, -41.22656), Vector2(182.266, -43.55859), Vector2(185.2668, -45.89101), Vector2(188.2674, -48.22371), Vector2(191.2678, -50.55659), Vector2(194.2681, -52.88961), Vector2(197.2683, -55.22273), Vector2(200.2684, -57.55591), Vector2(203.2685, -59.88913), Vector2(206.2686, -62.22239), Vector2(209.2686, -64.55567), Vector2(212.2686, -66.88897), Vector2(215.2687, -69.22227), Vector2(218.2687, -71.55559), Vector2(221.2687, -73.88891), Vector2(224.2687, -76.22224), Vector2(227.2687, -78.55556), Vector2(230.2687, -80.88889), Vector2(233.2687, -83.22222), Vector2(236.2687, -85.55555), Vector2(239.2687, -87.88888), Vector2(242.2687, -90.22221), Vector2(245.2687, -92.55555), Vector2(248.2687, -94.88889), Vector2(251.2687, -97.22222), Vector2(254.2687, -99.55556), Vector2(257.2687, -101.8889), Vector2(260.2687, -104.2222), Vector2(263.2687, -106.5556), Vector2(266.2687, -108.8889), Vector2(269.2687, -111.2222), Vector2(272.2687, -113.5556), Vector2(275.2687, -115.8889), Vector2(278.2687, -118.2222), Vector2(281.2687, -120.5556), Vector2(284.2687, -122.8889), Vector2(287.2687, -125.2223), Vector2(290.2687, -127.5556), Vector2(293.2687, -129.8889), Vector2(296.2687, -132.2222), Vector2(299.2687, -134.5556), Vector2(302.2687, -136.8889), Vector2(305.2687, -139.2222), Vector2(308.2687, -141.5556), Vector2(311.2687, -143.8889), Vector2(314.2687, -146.2222), Vector2(317.2687, -148.5555), Vector2(320.2687, -150.8889), Vector2(323.2687, -153.2222), Vector2(326.2687, -155.5555), Vector2(329.2687, -157.8889), Vector2(332.2687, -160.2222), Vector2(335.2687, -162.5555), Vector2(338.2687, -164.8888), Vector2(341.2687, -167.2222), Vector2(344.2687, -169.5555), Vector2(347.2687, -171.8888), Vector2(350.2687, -174.2222), Vector2(353.2687, -176.5555), Vector2(356.2687, -178.8888), Vector2(359.2687, -181.2221), Vector2(362.2687, -183.5555), Vector2(365.2687, -185.8888), Vector2(368.2687, -188.2221), Vector2(371.2687, -190.5555), Vector2(374.2687, -192.8888), Vector2(377.2687, -195.2221), Vector2(380.2687, -197.5554), Vector2(383.2687, -199.8888), Vector2(386.2687, -202.2221), Vector2(389.2687, -204.5554), Vector2(392.2687, -206.8887), Vector2(395.2687, -209.2221), Vector2(398.2687, -211.5554), Vector2(401.2687, -213.8887), Vector2(404.2687, -216.2221), Vector2(407.2687, -218.5554), Vector2(410.2687, -220.8887), Vector2(413.2687, -223.222), Vector2(416.2687, -225.5554)], 
[Vector2(112.0, 0.0), Vector2(117.8824, -0.7), Vector2(122.4486, -1.89), Vector2(126.3965, -3.423), Vector2(130.0025, -5.1961), Vector2(133.4025, -7.13727), Vector2(136.6718, -9.19609), Vector2(139.8553, -11.33726), Vector2(142.9814, -13.53608), Vector2(146.0686, -15.77526), Vector2(149.1292, -18.04268), Vector2(152.1713, -20.32988), Vector2(155.2006, -22.63091), Vector2(158.2211, -24.94164), Vector2(161.2354, -27.25915), Vector2(164.2454, -24.93689), Vector2(166.5591, -28.25915), Vector2(170.3677, -29.88473), Vector2(177.3223, -30.32263), Vector2(184.4986, -29.92916), Vector2(189.5608, -28.95374), Vector2(193.7576, -27.57094), Vector2(197.5058, -25.90298), Vector2(200.993, -24.03541), Vector2(204.3183, -22.02811), Vector2(207.5388, -19.923), Vector2(210.6898, -17.74942), Vector2(213.7939, -15.52792), Vector2(216.8661, -13.27287), Vector2(219.9162, -10.99433), Vector2(222.9512, -8.699354), Vector2(225.9755, -6.392871), Vector2(228.9925, -4.078333), Vector2(232.0044, -1.758156), Vector2(235.0127, 0.565968), Vector2(238.0186, 2.892854), Vector2(241.0226, 5.221674), Vector2(244.0255, 7.551849), Vector2(247.0275, 9.882971), Vector2(250.0289, 12.21476), Vector2(253.0298, 14.54701), Vector2(256.0305, 16.87958), Vector2(259.031, 19.21238), Vector2(262.0313, 21.54535), Vector2(265.0316, 23.87842), Vector2(268.0317, 26.21157), Vector2(271.0319, 28.54478), Vector2(274.032, 30.87802), Vector2(277.032, 33.21129), Vector2(280.032, 35.54458), Vector2(283.0321, 37.87788), Vector2(286.0321, 40.21119), Vector2(289.0321, 42.54451), Vector2(292.0321, 44.87783), Vector2(295.0321, 47.21116), Vector2(298.0321, 44.87783), Vector2(300.3398, 48.21116), Vector2(304.1373, 49.84449), Vector2(311.0657, 50.28782), Vector2(318.2617, 49.89816), Vector2(323.3307, 48.92539), Vector2(327.5307, 47.54445), Vector2(331.2807, 45.8778), Vector2(334.7691, 44.01114), Vector2(338.095, 42.00447), Vector2(341.316, 39.89981), Vector2(344.4673, 37.72655), Vector2(347.5717, 35.50526), Vector2(350.644, 33.25036), Vector2(353.6942, 30.97193), Vector2(356.7292, 28.67703), Vector2(359.7536, 26.3706), Vector2(362.7707, 24.0561), Vector2(365.7826, 21.73595), Vector2(368.7909, 19.41184), Vector2(371.7967, 17.08497), Vector2(374.8008, 14.75616), Vector2(377.8036, 12.42599), Vector2(380.8056, 10.09487), Vector2(383.807, 7.763091), Vector2(386.808, 5.430843), Vector2(389.8087, 3.09827), Vector2(392.8092, 0.765469), Vector2(395.8095, -1.567492), Vector2(398.8098, 0.76558), Vector2(401.1176, -2.567492), Vector2(404.9153, -4.200644), Vector2(411.8443, -4.643849), Vector2(419.0398, -4.254093), Vector2(424.1087, -3.281264), Vector2(428.3086, -1.900283), Vector2(432.0586, -0.233597), Vector2(435.5469, 1.633083), Vector2(438.8729, 3.63976), Vector2(442.0938, 1.535086), Vector2(444.5301, 4.63976), Vector2(448.5733, 6.113031), Vector2(456.0848, 6.444321), Vector2(462.8964, 5.976224), Vector2(467.8281, 4.948556)], [Vector2(112.0, 0.0), Vector2(117.8824, -0.7), Vector2(122.4486, -1.89), Vector2(126.3965, -3.423), Vector2(130.0025, -5.1961), Vector2(133.4025, -7.13727), Vector2(136.6718, -9.19609), Vector2(139.8553, -11.33726), Vector2(142.9814, -13.53608), Vector2(146.0686, -15.77526), Vector2(149.1292, -18.04268), Vector2(152.1713, -20.32988), Vector2(155.2006, -22.63091), Vector2(158.2211, -24.94164), Vector2(161.2354, -27.25915), Vector2(164.2454, -29.5814), Vector2(167.2524, -31.90698), Vector2(170.2573, -29.57908), Vector2(172.5679, -32.90698), Vector2(176.3709, -34.53651), Vector2(183.3121, -34.97719), Vector2(190.4984, -34.58566), Vector2(195.5641, -33.61159), Vector2(199.7625, -34.99343), Vector2(202.7195, -32.61159), Vector2(207.8026, -31.64429), Vector2(217.5788, -31.66719), Vector2(223.4062, -32.38321), Vector2(227.9491, -33.58443), Vector2(231.8848, -32.04358), Vector2(234.709, -34.58443), Vector2(239.5199, -35.66303), Vector2(248.9985, -35.71805), Vector2(255.0172, -35.05656), Vector2(259.6403, -33.89352), Vector2(263.6178, -35.40765), Vector2(266.4634, -32.89352), Vector2(271.3181, -31.83363), Vector2(280.9157, -31.79171), Vector2(286.9014, -32.46236), Vector2(291.5108, -31.2929), Vector2(294.6659, -33.46236), Vector2(300.1646, -34.28098), Vector2(309.038, -34.15401), Vector2(314.6281, -33.36514), Vector2(319.0681, -32.11293), Vector2(322.9493, -33.68948), Vector2(325.7453, -31.11293), Vector2(330.4991, -30.00934), Vector2(339.823, -29.93683), Vector2(345.8864, -30.58608), Vector2(350.5279, -29.43161), Vector2(353.698, -31.58608), Vector2(359.2286, -32.39421), Vector2(368.0446, -32.2599), Vector2(373.6187, -31.46588), Vector2(378.0516, -30.21007), Vector2(381.929, -28.631), Vector2(385.4936, -30.43635), Vector2(388.1215, -27.631), Vector2(392.5389, -26.36726), Vector2(400.9805, -26.18264), Vector2(407.3468, -25.61188), Vector2(411.2367, -27.18264), Vector2(418.3819, -27.58218), Vector2(425.4226, -27.16185), Vector2(430.437, -26.16763), Vector2(434.6107, -24.77167), Vector2(438.346, -23.0945), Vector2(441.8255, -24.96852), Vector2(444.4068, -22.0945), Vector2(448.7324, -20.78268), Vector2(456.9408, -20.56441), Vector2(463.4041, -20.0172), Vector2(467.3299, -21.56441), Vector2(474.5603, -21.94746), Vector2(481.5442, -21.51559), Vector2(486.5385, -20.51329), Vector2(490.7023, -19.11167), Vector2(494.4321, -17.43054), Vector2(497.9082, -15.55375), Vector2(501.2263, -13.54), Vector2(504.4421, -11.43037), Vector2(507.59, -9.253632), Vector2(510.692, -11.47735), Vector2(513.0596, -8.253632), Vector2(516.9711, -6.697029), Vector2(524.1673, -6.307407), Vector2(531.1737, -5.880143), Vector2(535.2936, -7.307407), Vector2(542.9913, -7.606493), Vector2(549.6999, -7.115853), Vector2(554.5936, -6.072405), Vector2(558.7081, -4.641991), Vector2(562.41, -2.940701), Vector2(565.8691, -1.049799), Vector2(569.1764, 0.973833), Vector2(572.3851, 3.090375), Vector2(575.5281, 5.271955), Vector2(578.6269, 7.499061)]
,[Vector2(112.0, 0.0), Vector2(117.8824, -0.7), Vector2(122.4486, -1.89), Vector2(126.3965, -3.423), Vector2(130.0025, -5.1961), Vector2(133.4025, -7.13727), Vector2(136.6718, -9.19609), Vector2(139.8553, -11.33726), Vector2(142.9814, -13.53608), Vector2(146.0686, -15.77526), Vector2(149.1292, -18.04268), Vector2(152.1713, -20.32988), Vector2(155.2006, -22.63091), Vector2(158.2211, -24.94164), Vector2(161.2354, -27.25915), Vector2(164.2454, -29.5814), Vector2(167.2524, -27.25583), Vector2(169.5643, -30.5814), Vector2(173.3696, -32.20931), Vector2(180.3163, -32.64884), Vector2(187.4985, -32.25652), Vector2(192.5627, -31.28189), Vector2(196.7605, -29.89965), Vector2(200.5092, -28.23208), Vector2(203.9968, -26.36478), Vector2(207.3223, -24.35767), Vector2(210.5429, -22.2527), Vector2(213.694, -20.07921), Vector2(216.7982, -17.85777), Vector2(219.8704, -15.60277), Vector2(222.9206, -13.32426), Vector2(225.9555, -11.02931), Vector2(228.9799, -8.722843), Vector2(231.9969, -6.408316), Vector2(235.0088, -4.088147), Vector2(238.0171, -1.764029), Vector2(241.0229, 0.562854), Vector2(244.027, 2.891672), Vector2(247.0299, 5.221845), Vector2(250.0319, 7.552966), Vector2(253.0333, 9.88475), Vector2(256.0342, 12.217), Vector2(259.0349, 14.54957), Vector2(262.0354, 16.88238), Vector2(265.0357, 19.21534), Vector2(268.036, 21.54841), Vector2(271.0361, 23.88156), Vector2(274.0363, 26.21477), Vector2(277.0363, 28.54801), Vector2(280.0364, 30.88128), Vector2(283.0364, 33.21457), Vector2(286.0365, 35.54787), Vector2(289.0365, 37.88119), Vector2(292.0365, 40.2145), Vector2(295.0365, 42.54783), Vector2(298.0365, 44.88115), Vector2(301.0365, 47.21448), Vector2(304.0365, 49.54781), Vector2(307.0365, 51.88114), Vector2(310.0365, 54.21447), Vector2(313.0365, 56.54781), Vector2(316.0365, 58.88114), Vector2(319.0365, 61.21447), Vector2(322.0365, 63.5478), Vector2(325.0365, 65.88113), Vector2(328.0365, 68.21447), Vector2(331.0365, 70.54781), Vector2(334.0365, 72.88114), Vector2(337.0365, 75.21448), Vector2(340.0365, 77.54781), Vector2(343.0365, 79.88115), Vector2(346.0365, 82.21449), Vector2(349.0365, 84.54782), Vector2(352.0365, 86.88116), Vector2(355.0365, 89.21449), Vector2(358.0365, 91.54783), Vector2(361.0365, 93.88116), Vector2(364.0365, 96.2145), Vector2(367.0365, 98.54784), Vector2(370.0365, 100.8812), Vector2(373.0365, 103.2145), Vector2(376.0365, 105.5478), Vector2(379.0365, 103.2145), Vector2(381.3442, 106.5478), Vector2(385.1416, 108.1812), Vector2(392.07, 108.6245), Vector2(399.266, 108.2348), Vector2(404.3351, 107.2621), Vector2(408.5351, 105.8811), Vector2(412.2851, 104.2145), Vector2(415.7735, 102.3478), Vector2(419.0995, 100.3412), Vector2(422.3204, 98.23651), Vector2(425.4717, 96.06325), Vector2(428.5761, 93.84196), Vector2(431.6484, 91.58707), Vector2(434.6986, 89.30864), Vector2(437.7336, 87.01374), Vector2(440.758, 84.70731), Vector2(443.7751, 82.39281)]
]
@export var current_goal = 0

func start() -> void:
	points = []
	pos = position
	if goal:
		get_child(0).points = goals[current_goal]
	for i in len:
		pos += Vector2.RIGHT*(speed/(abs(a)+1))
		if not Input.is_action_pressed("Space"):
			pos.y -= a  
			a += 1
		else:
			pos.y += a
			a +=  1
		if Input.is_action_just_pressed("Space") or Input.is_action_just_released("Space"):
			a *=-1
		else:
			a*=0.7
		if a > 5:
			a = 5
		add_point(pos)
		await get_tree().process_frame
	var g = Gradient.new()
	#print(points)
	g.remove_point(0)
	gradient = g
	if goal:
		for j in points.size():
			score -= floor(points[j].distance_to(get_child(0).points[j]))
		if score < 0: score = 0
	done = true
